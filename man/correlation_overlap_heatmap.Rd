% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlation_overlap_heatmap.R
\name{correlation_overlap_heatmap}
\alias{correlation_overlap_heatmap}
\title{Plot Pairwise Correlations and Overlaps of Multiple Gene Sets}
\usage{
correlation_overlap_heatmap(
  betas,
  tissue_names = colnames(betas),
  main_title = "Correlation (lower) and number of shared features (upper)",
  cor_method = "pearson"
)
}
\arguments{
\item{betas}{A numeric data frame or matrix where rows are genes and
columns are tissues/cell types. Missing values (NA) indicate gene absence.}

\item{tissue_names}{Optional vector of tissue names. Must match
\code{ncol(betas)}. Defaults to column names or sequential numbering.}

\item{main_title}{Optional main title for plot.}

\item{cor_method}{Correlation method passed to \code{psych::corr.test()}.
One of \code{"pearson"}, \code{"kendall"}, \code{"spearman"}.}
}
\value{
A ggplot2 heatmap object, or the number of non-NA entries in \code{betas}
if it only contains one column.
}
\description{
Produces a two-layer heatmap summarizing:
}
\details{
Lower triangle:
Pairwise complete correlations between gene-level effect sizes
Significance stars computed from FDR-adjusted p-values

Upper triangle:
Number of shared non-missing effect sizes (pairwise N)
Text labels show N

Diagonal:
Number of non-missing values per tissue

Internally uses \code{psych::corr.test()} to compute correlations, p-values,
and pairwise complete sample sizes.
}
\examples{
\dontrun{
correlation_overlap_heatmap(
  betas = data.frame(
    A = c(1, 7, 3),
    B = c(1, 6, 3),
    C = c(10, -9, NA)
  ),
  tissue_names = c("A", "B", "C"))
}

}
\references{
Bache, S., Wickham, H. (2022). magrittr: A Forward-Pipe Operator for R. R package
version 2.0.3. https://CRAN.R-project.org/package=magrittr.

Campitelli, E. (2025). ggnewscale: Multiple Fill and Colour Scales in 'ggplot2'. R
package version 0.5.2, https://CRAN.R-project.org/package=ggnewscale.

Revelle, W. (2025). psych: Procedures for Psychological, Psychometric, and
Personality Research. Northwestern University, Evanston, Illinois. R package
version 2.5.6. https://CRAN.R-project.org/package=psych.

Wickham, H., François, R., Henry, L., Müller, K., Vaughan, D. (2023). dplyr:
A Grammar of Data Manipulation. R package version 1.1.4.
https://CRAN.R-project.org/package=dplyr.

Wickham, H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

Wickham, H., Vaughan, D., Girlich, M. (2024). tidyr: Tidy Messy Data. R package version 1.3.1. https://CRAN.R-project.org/package=tidyr.
}
