% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlation_overlap_heatmap.R
\name{correlation_overlap_heatmap}
\alias{correlation_overlap_heatmap}
\title{Plot Pairwise Correlations and Overlaps of Multiple Gene Sets}
\usage{
correlation_overlap_heatmap(
  betas,
  tissue_names = colnames(betas),
  main_title = "Correlation (lower) and number of shared features (upper)",
  cor_method = "pearson"
)
}
\arguments{
\item{betas}{A numeric data frame or matrix where rows are genes and
columns are tissues/cell types. Missing values (NA) indicate gene absence.}

\item{tissue_names}{Optional vector of tissue names. Must match
\code{ncol(betas)}. Defaults to column names or sequential numbering.}

\item{main_title}{Optional main title for plot.}

\item{cor_method}{Correlation method passed to \code{psych::corr.test()}.
One of \code{"pearson"}, \code{"kendall"}, \code{"spearman"}.}
}
\value{
A ggplot2 heatmap object.
}
\description{
Produces a two-layer heatmap summarizing:
}
\details{
Lower triangle:
Pairwise complete correlations between gene-level effect sizes
Significance stars computed from FDR-adjusted p-values

Upper triangle:
Number of shared non-missing effect sizes (pairwise N)
Text labels show N

Diagonal:
Number of non-missing values per tissue

Internally uses \code{psych::corr.test()} to compute correlations, p-values,
and pairwise complete sample sizes.
}
\examples{
correlation_overlap_heatmap(
  betas = data.frame(
    A = c(1, 7, 3),
    B = c(1, 6, 3),
    C = c(10, -9, NA)
  ),
  tissue_names = c("A", "B", "C"))

}
\references{
Revelle, W. (2024). \emph{psych: Procedures for Psychological, Psychometric,
and Personality Research.} Northwestern University.
Wickham, H. (2016). \emph{ggplot2: Elegant Graphics for Data Analysis.} Springer.
}
