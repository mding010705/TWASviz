% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TWAS_to_adj_dataframe.R
\name{predixcan2adj_df}
\alias{predixcan2adj_df}
\title{Format PrediXcan Association Output into Gene Adjacency Matrix}
\usage{
predixcan2adj_df(
  predixcan_assoc_filenames,
  gene_colname = "gene",
  effect_size_colname = "zscore",
  p_val_colname = "pvalue",
  tissue_names = seq_along(predixcan_assoc_filenames),
  use_fdr = FALSE,
  pvalue_thresh = 0.05
)
}
\arguments{
\item{predixcan_assoc_filenames}{Vector of file paths to PrediXcan output files.
Each must contain columns: \code{gene}, \code{se}, and \code{pvalue}.}

\item{gene_colname}{Name of column in predixcan_assoc_filenames that contains
the gene name.}

\item{effect_size_colname}{Name of column in predixcan_assoc_filenames that
contains the effect size.}

\item{p_val_colname}{Name of column in predixcan_assoc_filenames that
contains the p-value.}

\item{tissue_names}{Names for tissues/conditions. Defaults to index sequence.}

\item{use_fdr}{If TRUE, convert p-values to q-values.}

\item{pvalue_thresh}{Threshold for p-value or q-value significance.}
}
\value{
A gene × tissue adjacency matrix of PrediXcan effect sizes.
}
\description{
Reads multiple PrediXcan association result files and constructs an
adjacency-matrix-like data frame where rows are genes and columns are
tissues/conditions, storing the effect size (standard error or beta).
}
\details{
Filters genes using either a p-value threshold or FDR-based q-value
threshold (Storey & Tibshirani 2003).

\strong{References}
\itemize{
\item Gamazon, E. R., et al. (2015).
\emph{PrediXcan: Trait prediction from transcriptome data integrates genetic regulation.}
Nature Genetics, 47, 1091–1098.
\item Storey, J. D., & Tibshirani, R. (2003).
\emph{Statistical significance for genomewide studies.} PNAS, 100(16), 9440–9445.
}
}
\examples{
\dontrun{
  files <- c("inst/extdata/predixcan_twas1.txt",
  "inst/extdata/predixcan_twas2.txt")

  adj <- predixcan2adj_df(
    predixcan_assoc_filenames = files,
    tissue_names = c("Cell1", "Cell2"),
    use_fdr = TRUE,
    pvalue_thresh = 0.10
  )

  head(adj)
}

}
