% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TWAS_to_adj_dataframe.R
\name{predixcan2adj_df}
\alias{predixcan2adj_df}
\title{Format PrediXcan Association Output into Gene Adjacency Matrix}
\usage{
predixcan2adj_df(
  predixcan_assoc_filenames,
  gene_colname = "gene",
  effect_size_colname = "zscore",
  pvalue_colname = "pvalue",
  tissue_names = seq_along(predixcan_assoc_filenames),
  use_fdr = FALSE,
  pvalue_thresh = 0.05
)
}
\arguments{
\item{predixcan_assoc_filenames}{Vector of file paths to PrediXcan output files.
Each must contain columns: \code{gene}, \code{se}, and \code{pvalue}.}

\item{gene_colname}{Name of column in predixcan_assoc_filenames that contains
the gene name.}

\item{effect_size_colname}{Name of column in predixcan_assoc_filenames that
contains the effect size.}

\item{pvalue_colname}{Name of column in predixcan_assoc_filenames that
contains the p-value.}

\item{tissue_names}{Names for tissues/conditions. Defaults to index sequence.}

\item{use_fdr}{If TRUE, convert p-values to q-values.}

\item{pvalue_thresh}{Threshold for p-value or q-value significance.}
}
\value{
A gene × tissue adjacency matrix of PrediXcan effect sizes.
}
\description{
Reads multiple PrediXcan (Gamazon et al., 2015) association result files and constructs an
adjacency-matrix-like data frame where rows are genes and columns are
tissues/conditions, storing the effect size (standard error or beta).
}
\details{
Filters genes using either a p-value threshold or FDR-based q-value
threshold (Storey & Tibshirani, 2003).
}
\examples{
\dontrun{
  files <- c("inst/extdata/predixcan_twas1.txt",
  "inst/extdata/predixcan_twas2.txt")

  adj <- predixcan2adj_df(
    predixcan_assoc_filenames = files,
    tissue_names = c("Cell1", "Cell2"),
    use_fdr = TRUE,
    pvalue_thresh = 0.10
  )

  head(adj)
}

}
\references{
Gamazon, E. R., Wheeler, H. E., Shah, K. P., Mozaffari, S. V.,
Aquino-Michaels, K., Carroll, R. J., Eyler, A. E., Denny, J. C., Nicolae,
D. L., Cox, N. J., & Im, H. K. (2015). A gene-based association method for
mapping traits using reference transcriptome data. Nature Genetics, 47(9),
1091–1098. https://doi.org/10.1038/ng.3367.

Storey, J. D., & Tibshirani, R. (2003). Statistical significance for genomewide
studies. Proceedings of the National Academy of Sciences, 100(16), 9440–9445.
https://doi.org/10.1073/pnas.1530509100.

Barrett, T., Dowle, M., Srinivasan, A., Gorecki, J., Chirico, M., Hocking, T.,
Schwendinger, B., Krylov, I. (2025). data.table: Extension of \code{data.frame}.
R package version 1.17.8, https://CRAN.R-project.org/package=data.table.
}
