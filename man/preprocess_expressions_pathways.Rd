% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sgl_preprocessing.R
\name{preprocess_expressions_pathways}
\alias{preprocess_expressions_pathways}
\title{Formatting Gene Expression and Pathway Data for Sparse Group Lasso}
\usage{
preprocess_expressions_pathways(
  gene_expr,
  all_pathways,
  phenotype_filename = NULL,
  phenotype_colname = NULL,
  covariates_filename = NULL,
  covariates_colnames = NULL,
  family_func = "gaussian"
)
}
\arguments{
\item{gene_expr}{Data frame containing imputed expression data.
Must contain first two columns named \strong{FID} and \strong{IID} and remaining
columns representing gene expression.}

\item{all_pathways}{A named list where each element is a character vector
of genes belonging to a pathway. Names represent pathway names.}

\item{phenotype_filename}{Path to phenotype text file containing at least
the column \code{IID} and the phenotype column specified by \code{phenotype_colname}.}

\item{phenotype_colname}{Name of the phenotype column in phenotype file.}

\item{covariates_filename}{(Optional) path to covariates file that must
contain \code{IID} and columns listed in \code{covariates_colnames}.}

\item{covariates_colnames}{Vector of covariate column names to extract.}

\item{family_func}{Model family specification (i.e., \code{"gaussian"}, \code{"binomial"}).
Passed to \code{glm()}. See \code{?stats::family} for details.}
}
\value{
A list containing:
\describe{
\item{X}{Processed gene expression matrix with duplicated pathway genes.}
\item{y}{Vector of phenotype values (residualized if Gaussian).}
\item{groups}{Integer vector defining pathway grouping for group lasso.}
\item{gene2pathway}{List mapping genes to the pathways they belong to.}
\item{IID}{Participant IDs used (sorted).}
\item{offsets}{NULL (Gaussian) or vector of glm predicted offsets
(non-Gaussian).}
\item{processed_pathways}{Named list of pathway-specific duplicated genes.}
}
}
\description{
This function prepares imputed gene expression data, phenotype data, and
pathway annotations for downstream sparse group lasso analysis.
}
\details{
It performs the following:
\enumerate{
\item Sorts gene expression data by IID and removes FID/IID columns.
\item Subsets and aligns phenotype and covariate files to the same individuals
and in the same order as \code{gene_expr}.
\item If covariates are provided:
• Fits \code{glm(phenotype ~ covariates, family = family_func)}
• Returns offsets = predicted values (for non-Gaussian families)
• Returns residualized phenotype (for Gaussian families only)
\item Expands pathways so genes appearing in multiple pathways are duplicated,
renamed as \code{gene_pathway}.
\item Constructs pathway group indices for sparse group lasso.
}
}
\examples{
\dontrun{
preprocess_expressions_pathways(
  gene_expr = data.frame(
    FID = 1:3, IID = 1:3,
    G1 = rnorm(3), G2 = rnorm(3), G3 = rnorm(3)
  ),
  all_pathways = list(
    PW1 = c("G1", "G2"),
    PW2 = c("G2", "G3")
  ),
  phenotype_filename = "pheno.txt",
  phenotype_colname = "BMI",
  covariates_filename = "covars.txt",
  covariates_colnames = c("age", "sex"),
  family_func = "gaussian"
)
}

}
\references{
Liang, X., Cohen, A., Solón Heinsfeld, A., Pestilli, F., McDonald,
D.J. (2024). “sparsegl: An R Package for Estimating Sparse Group Lasso.”
Journal of Statistical Software, 110(6), 1-23. doi:10.18637/jss.v110.i06.
https://doi.org/10.18637/jss.v110.i06.

Barrett, T., Dowle, M., Srinivasan, A., Gorecki, J., Chirico, M., Hocking, T.,
Schwendinger, B., Krylov, I. (2025). data.table: Extension of \code{data.frame}.
R package version 1.17.8, https://CRAN.R-project.org/package=data.table.
}
