% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sgl_TWAS.R
\name{sgl_TWAS}
\alias{sgl_TWAS}
\title{Perform Sparse Group Lasso TWAS}
\usage{
sgl_TWAS(
  X,
  y,
  grouping = NULL,
  family_func = "gaussian",
  pred_loss = "mse",
  offsets = NULL,
  nfolds = 10
)
}
\arguments{
\item{X}{Numeric matrix of imputed gene expression values,
where rows are samples and columns are genes.}

\item{y}{Vector of phenotype values (continuous, or binary).}

\item{grouping}{Integer vector assigning each gene to a pathway group.
Must be consecutive integers (1, 2, 3, …).
If \code{NULL}, the sparse group lasso reduces to standard lasso.}

\item{family_func}{Model family specification (i.e., \code{"gaussian"}, \code{"binomial"}).
Passed to \code{cv.sparsegl()}. See \code{?stats::family} for details.}

\item{pred_loss}{Loss function for cross-validation. Valid options:
\code{"default"}, \code{"mse"}, \code{"deviance"}, \code{"mae"}, \code{"misclass"}.}

\item{offsets}{Optional numeric vector of offsets. Useful for models with
baseline risk or exposure variables.}

\item{nfolds}{Number of cross-validation folds. Must be ≥3.}
}
\value{
A list containing:
\describe{
\item{sgl_fit}{The full \code{cv.sparsegl} model object.}
\item{lambda1se_coef}{A sparse coefficient matrix (\code{dgCMatrix})
containing gene names and coefficients at the \code{lambda.1se} value.}
}
}
\description{
Performs a Transcriptome-Wide Association Study (TWAS) using the
Sparse Group Lasso (SGL), given imputed gene expression data, phenotype
values, pathway-based group assignments, and optional offsets.
}
\details{
Internally, this function fits a cross-validated Sparse Group Lasso model
using \code{sparsegl::cv.sparsegl()}, then extracts the coefficients
at the \emph{lambda.1se} value (the most regularized model within one standard
error of the minimum CV error), typically used for stability and
interpretability in TWAS.

\strong{References}
\itemize{
\item Liang, X., Cohen, A., Sólon Heinsfeld, A., Pestilli, F., & McDonald, D.J. (2024).
\emph{sparsegl: An R Package for Estimating Sparse Group Lasso.}
Journal of Statistical Software, 110(6), 1–23.
doi:10.18637/jss.v110.i06
\item Simon, N., Friedman, J., Hastie, T., & Tibshirani, R. (2013).
\emph{A Sparse-Group Lasso.} Journal of Computational and Graphical Statistics, 22(2), 231–245.
}
}
\examples{
\dontrun{
  # Simulated data for demonstration
  set.seed(123)
  X <- matrix(rnorm(200 * 50), nrow = 200, ncol = 50)
  y <- rnorm(200)

  # Group 50 genes into 10 pathways
  grouping <- rep(1:10, each = 5)

  # Run TWAS using Sparse Group Lasso
  twas_res <- sgl_TWAS(
    X = X,
    y = y,
    grouping = grouping,
    family_func = "gaussian",
    pred_loss = "mse",
    nfolds = 5
  )

  # Inspect fitted object
  twas_res$sgl_fit

  # Extract gene coefficients at lambda.1se
  coef_1se <- twas_res$lambda1se_coef
  head(coef_1se)
}

}
